# 데드락(DeadLock)
교착 상태라고도 하며, 두 개 이상의 프로세스들이 서로 가진 자원을 기다리며 중단된 상태를 말한다.

> 즉, 둘 이상의 프로세스가 남이 가진 자원을 서로 요구하면서 양쪽 모두 작업 수행을 할 수 없어 중단 상태로 놓이는 상태를 말한다.

## 공유 자원(Shared Resource)
시스템 안에서 각 프로세스, 스레드가 함께 접근할 수 있는 모니터, 프린터, 메모리, 파일, 데이터 등의 자원이나 변수 등을 의미한다.

### 경쟁 상태(Race Condition)
이 공유 자원을 두개 이상의 프로세스가 동시에 읽거나 쓰는 상황을 말한다.

동시에 접근을 시도하면 접근 타이밍이나 순서 등이 결괏값에 영향을 주게 된다.

예를 들어, int 변수가 100이 었는데 각 프로세스 A와 B가 100을 덧셈해주려고 한다. <br/>
이때, 프로세스 A가 먼저 100이라는 숫자를 로드하였다. 프로세스 B가 100을 확인하고 100을 더해서 200이 되었다.  <br/>
하지만, 프로세스 A는 먼저 100이라는 숫자를 확인하였기 때문에 100에 100을 더하여 200만 더하게 된다.

결과적으로 B의 계산도 포함하여 300이 되어야하는 결과가 동시 접근으로 인하여 타이밍이 꼬여 결괏값이 200이 출력되는 것이다.

## 임계 영역(Critical Section)
둘 이상의 프로세스, 둘 이상의 스레드가 공유 자원에 접근할 때 순서 등의 이유로 결과가 달라지는 코드 영역을 말한다.

### 임계 영역 해결 방안
임계 영역을 해결하기 위한 방법은 크게 3가지가 존재한다. 이 방법들은 모두 '상호 배제, 한정 대기, 융통성'이라는 조건을 만족한다.<br/>
이 방법에 토대가 되는 메커니즘은 잠금(Lock)이다. 

예를 들면, 임계 영역이 화장실이라 한다면 화장실에 A라는 사람이 들어간 다음 문을 잠그면 다음 사람이 기다리다 A가 나오면 화장실을 쓰는 것이다.

#### 상호 배제 (Mutual Exclusion)
한 프로세스가 임계 영역에 들어갔을 때 다른 프로세스는 들어갈 수 없다.
#### 한정 대기(Bounded Waiting)
특정 프로세스가 영원히 임계 영역에 들어가지 못하면 안 된다.
#### 융통성(Progress)
만약 어떠한 프로세스도 임계 영역을 사용하지 않는다면 임계 영역 외부의 어떠한 프로세스도 들어갈 수 있으며 이때 프로세스 끼리 서로 방해하지 않는다.

#### 해결방안
1. 뮤텍스
2. 세마포어
3. 모니터

### 뮤텍스(Mutex)
프로세스나 스레드가 공유 자원을 lock()을 통해 잠금 설정하고 사용한 후에는 unlock()을 통해 잠금 해제하는 객체다.

잠금이 설정되면 다른 프로세스나 스레드는 잠긴 코드 영역에 접근할 수 없고, 해제가 된다면 접근할 수 있다.

따라서, 뮤텍스는 '잠금' 또는 '잠금 해제'라는 상태만 가진다.

### 세마포어(SemePhore)
일반화된 뮤텍스로, 간단한 정수 값과 두 가지의 함수 wait(P함수) 및 signal(V 함수)로 공유 자원에 접근을 처리한다.

프로세스나 스레드가 공유 자원에 접근하면 세마포어에서 wait() 작업을 수행하고, 프로세스나 스레드가 공유 자원을 해제하면 세마포어에서 signal() 작업을 수행한다.

> **wait()** <br/> 자신의 차례가 올 때까지 기다리는 함수다.

> **signal()** <br/> 다음 프로세스로 순서를 넘겨주는 함수다.

***세마포어에는 조건 변수가 없고, 프로세스나 스레드가 세마포어 값을 수정할 때 다른 프로세스나 스레드는 동시에 세마포어 값을 수정할 수 없다.***

#### 바이너리 세마포어
0과 1의 두 가지 값만 가질 수 있는 세마포어다.

구현의 유사성으로 뮤텍스는 바이너리 세마포어라고도 할 수 있긴 하지만, 뮤텍스는 잠금을 기반으로 상호배제가 일어나는 '잠금 메커니즘'이고 
세마포어는 신호를 기반으로 일어나는 '신호 메커니즘'이기 때문에 서로 다르다고 할 수 있다.

예를 들면, 신호 메커니즘은 휴대폰에서 노래를 듣다가 친구로부터 전화가 오면 노래가 중지되고 통화 처리 작업에 관한 인터페이스가 등장하는 것이다.

#### 카운팅 세마포어
여러 개의 값을 가질 수 있는 세마포어다. 여러 자원에 대한 접근을 제어하는 데 사용한다.

### 모니터(Monitor)
모니터는 둘 이상의 스레드나 프로세스가 공유 자원에 안전하게 접근할 수 있도록 공유 자원을 숨기고 해당 접근에 대해 인터페이스만 제공하는 것을 말한다.

모니터는 모니터큐를 통해 공유 자원에 대한 작업들을 순차적으로 처리한다.

모니터는 세마포어보다 구현이 쉽다. <br/>
모니터에서 상호 배제는 자동이지만, 세마포어에서는 상호 배제를 명시적으로 구현해야 한다.



